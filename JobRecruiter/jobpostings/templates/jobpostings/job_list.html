{% extends 'base.html' %}
{% block content %}
<div class="container py-4">
	<div class="d-flex justify-content-between align-items-center mb-3">
		<div class="d-flex align-items-center gap-3">
			<a href="{% url 'jobpostings:map' %}" class="btn btn-outline-secondary">
				<i class="fas fa-map-marker-alt"></i> Search on Map
			</a>
			<h3 class="mb-0">Job Openings</h3>
		</div>
		{% if user.is_authenticated and user.profile.account_type == 'employer' %}
		<a href="{% url 'jobpostings:create' %}" class="btn btn-primary">Post a Job</a>
		{% endif %}
	</div>
	
	<!-- Search Form -->
	<div class="card mb-4">
		<div class="card-body">
			<form method="GET" class="row g-3">
				<div class="col-md-4">
					<label for="search" class="form-label">Search Jobs</label>
					<input type="text" class="form-control" id="search" name="search" 
						   value="{{ search_query }}" placeholder="Job title, company, or keywords...">
				</div>
				<div class="col-md-3">
					<label for="location" class="form-label">Location</label>
					<input type="text" class="form-control" id="location" name="location" 
						   value="{{ location_filter }}" placeholder="City, State, or Remote">
				</div>
				<div class="col-md-3">
					<label for="employment_type" class="form-label">Employment Type</label>
					<select class="form-select" id="employment_type" name="employment_type">
						<option value="">All Types</option>
						{% for value, label in employment_types %}
						<option value="{{ value }}" {% if employment_type_filter == value %}selected{% endif %}>
							{{ label }}
						</option>
						{% endfor %}
					</select>
				</div>
				<div class="col-md-2 d-flex align-items-end">
					<button type="submit" class="btn btn-primary w-100">
						<i class="fas fa-search"></i> Search
					</button>
				</div>
			</form>
			{% if search_query or location_filter or employment_type_filter %}
			<div class="mt-3">
				<a href="{% url 'jobpostings:list' %}" class="btn btn-outline-secondary btn-sm">
					<i class="fas fa-times"></i> Clear Filters
				</a>
			</div>
			{% endif %}
		</div>
	</div>
	{% if jobs %}
		<div class="list-group">
			{% for job in jobs %}
			<div class="list-group-item">
				<div class="d-flex w-100 justify-content-between">
					<div class="flex-grow-1">
						<h5 class="mb-1">{{ job.title }}</h5>
							<p class="mb-1">{{ job.company_name }} â€” {{ job.address }}, {{ job.location_display }}</p>
						<small>Pay: {{ job.pay_range_display }}</small>
					</div>
					<div class="d-flex flex-column align-items-end">
						<small class="text-muted mb-2">{{ job.created_at|date:"M d, Y" }}</small>
						<div class="btn-group" role="group">
							<a href="{% url 'jobpostings:detail' job.id %}" class="btn btn-outline-primary btn-sm">
								<i class="fas fa-eye"></i> View
							</a>
							<a href="{% url 'jobpostings:map' %}?location={{ job.address }}&job_id={{ job.id }}" class="btn btn-outline-info btn-sm">
								<i class="fas fa-map-marker-alt"></i> Show on Map
							</a>
							{% if user.is_authenticated and job.posted_by == user %}
							<a href="{% url 'jobpostings:edit' job.id %}" class="btn btn-outline-warning btn-sm">
								<i class="fas fa-edit"></i> Edit
							</a>
							{% endif %}
						</div>
					</div>
				</div>
			</div>
			{% endfor %}
		</div>
	{% else %}
		<p>No jobs posted yet.</p>
	{% endif %}
</div>

{% endblock content %} 